
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Documentation for Triage." name="description"/>
<link href="http://dssg.github.io/triage/dirtyduck/ml_governance/" rel="canonical"/>
<link href="../../assets/images/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.3.0, mkdocs-material-7.0.6" name="generator"/>
<title>Model governance - Triage Documentation</title>
<link href="../../assets/stylesheets/main.2c0c5eaf.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.7fa14f5b.min.css" rel="stylesheet"/>
<meta content="#546d78" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CUbuntu+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Ubuntu";--md-code-font-family:"Ubuntu Mono"}</style>
<link href="../../triage_docs.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="deep-orange" data-md-color-primary="blue-grey" data-md-color-scheme="" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#machine-learning-governance">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Triage Documentation" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Triage Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Triage Documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Model governance
            
          </span>
</div>
</div>
</div>
<div class="md-header__options">
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="http://github.com/dssg/triage" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    dssg/triage
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Triage Documentation" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Triage Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12z"></path></svg>
</a>
    Triage Documentation
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="http://github.com/dssg/triage" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    dssg/triage
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
        Get started with your own project
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Get started with your own project" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Get started with your own project
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/">
        Quickstart guide
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../triage_project_workflow/">
        Suggested workflow
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
        Dirty Duck Tutorial
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Dirty Duck Tutorial" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Dirty Duck Tutorial
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
        Welcome!
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dirty_duckling/">
        Dirty duckling
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" id="__nav_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_3">
        Case studies
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Case studies" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
          Case studies
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../problem_description/">
        Problem description
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../eis/">
        Early Warning System
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../inspections/">
        Resource prioritization
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" id="__nav_3_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_4">
        Triage
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Triage" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_4">
<span class="md-nav__icon md-icon"></span>
          Triage
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../triage_intro/">
        A deeper look into triage
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_5" id="__nav_3_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_5">
        Are you curious about the setup?
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Are you curious about the setup?" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_5">
<span class="md-nav__icon md-icon"></span>
          Are you curious about the setup?
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../infrastructure/">
        Infrastructure
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../data_preparation/">
        Data preparation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../for_the_impatient/">
        Quick setup
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
        Triage documentation
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Triage documentation" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Triage documentation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" id="__nav_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_1">
        Experiment
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Experiment" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_1">
<span class="md-nav__icon md-icon"></span>
          Experiment
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/experiment-config/">
        Experiment Configuration
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/feature-testing/">
        Testing Feature Configuration
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/running/">
        Running an Experiment
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1_4" id="__nav_4_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_1_4">
        Upgrading an Experiment
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Upgrading an Experiment" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_4_1_4">
<span class="md-nav__icon md-icon"></span>
          Upgrading an Experiment
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/upgrade-to-v8/">
        v7 -&gt; v8
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/upgrade-to-v7/">
        v6 -&gt; v7
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/upgrade-to-v6/">
        v5 -&gt; v6
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/upgrade-to-v5/">
        v3/v4 -&gt; v5
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/temporal-validation/">
        Temporal Validation Deep Dive
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/cohort-labels/">
        Cohort and Label Deep Dive
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/prediction-ranking/">
        Prediction Ranking
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/features/">
        Feature Generation Recipe Book
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/algorithm/">
        Experiment Algorithm
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../experiments/architecture/">
        Experiment Architecture
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2">
        Model selection
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Model selection" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
          Model selection
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../audition/audition_intro/">
        Intro to Audition
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../audition/model_selection/">
        Model Selection Concepts
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/audition/">
        API Reference
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" id="__nav_4_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_3">
        Postmodeling
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Postmodeling" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_3">
<span class="md-nav__icon md-icon"></span>
          Postmodeling
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../postmodeling/">
        Using Postmodeling
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../postmodeling/postmodeling-config/">
        Postmodeling &amp; Crosstabs Configuration
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Model governance
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Model governance
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-are-all-the-results-tables-about">
    What are all the results tables about?
  </a>
<nav aria-label="What are all the results tables about?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#triage_metadataexperiments">
    triage_metadata.experiments
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#metadata_modelmodel_groups">
    metadata_model.model_groups
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#triage_metadatamodels">
    triage_metadata.models
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#triage_metadatamatrices">
    triage_metadata.matrices
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-train_resultsevaluations">
    {test, train}_results.evaluations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test_train_resultsaequitas">
    {test_train}_results.aequitas
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-train_resultspredictions">
    {test, train}_results.predictions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-train_resultsfeature_importances">
    {test, train}_results.feature_importances
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#footnotes">
    Footnotes
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../predictlist/">
        Predictlist
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aws_batch/">
        Scaling up
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../db/">
        Database Provisioner
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_8" id="__nav_4_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_8">
        API Reference
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="API Reference" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_8">
<span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_8_1" id="__nav_4_8_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_8_1">
        Audition
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Audition" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_4_8_1">
<span class="md-nav__icon md-icon"></span>
          Audition
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/audition/auditioner/">
        Auditioner
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/audition/audition-config/">
        Audition Configuration
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/audition/selection_rules/">
        Selection Rules
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/audition/database-dependencies/">
        Database Dependencies
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-are-all-the-results-tables-about">
    What are all the results tables about?
  </a>
<nav aria-label="What are all the results tables about?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#triage_metadataexperiments">
    triage_metadata.experiments
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#metadata_modelmodel_groups">
    metadata_model.model_groups
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#triage_metadatamodels">
    triage_metadata.models
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#triage_metadatamatrices">
    triage_metadata.matrices
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-train_resultsevaluations">
    {test, train}_results.evaluations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test_train_resultsaequitas">
    {test_train}_results.aequitas
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-train_resultspredictions">
    {test, train}_results.predictions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#test-train_resultsfeature_importances">
    {test, train}_results.feature_importances
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#footnotes">
    Footnotes
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="http://github.com/dssg/triage/edit/master/docs/sources/dirtyduck/ml_governance.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="machine-learning-governance">Machine learning governance<a class="headerlink" href="#machine-learning-governance" title="Permanent link">#</a></h1>
<p>When <code>triage</code> executes the experiment, it creates a series of new schemas for storing the copious output of the experiment. The schemas are <code>test_results, train_results</code>, and <code>triage_metadata</code>. These schemas store the metadata of the trained models, features, parameters, and hyperparameters used in their training. It also stores the predictions and evaluations of the models on the test sets.</p>
<p>The schema <code>triage_metadata</code> is composed by the tables:</p>
<div class="highlight"><pre><span></span><code><span class="err">\</span><span class="n">dt</span><span class="w"> </span><span class="n">triage_metadata</span><span class="p">.</span><span class="o">*</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>List of relations</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Schema</td>
<td>Name</td>
<td>Type</td>
<td>Owner</td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>experiment<sub>matrices</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>experiment<sub>models</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>experiments</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>list<sub>predictions</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>matrices</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>model<sub>groups</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>models</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
</tbody>
</table>
<p>The tables contained in <code>test_results</code> are:</p>
<div class="highlight"><pre><span></span><code><span class="err">\</span><span class="n">dt</span><span class="w"> </span><span class="n">test_results</span><span class="p">.</span><span class="o">*</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>List of relations</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Schema</td>
<td>Name</td>
<td>Type</td>
<td>Owner</td>
</tr>
<tr>
<td>test<sub>results</sub></td>
<td>aequitas</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>test<sub>results</sub></td>
<td>evaluations</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>test<sub>results</sub></td>
<td>individual<sub>importances</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>test<sub>results</sub></td>
<td>predictions</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
</tbody>
</table>
<p>Lastly, if you have interest in how the model performed in the <em>training</em> data sets you could consult <code>train_results</code></p>
<div class="highlight"><pre><span></span><code><span class="err">\</span><span class="n">dt</span><span class="w"> </span><span class="n">train_results</span><span class="p">.</span><span class="o">*</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>List of relations</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Schema</td>
<td>Name</td>
<td>Type</td>
<td>Owner</td>
</tr>
<tr>
<td>train<sub>results</sub></td>
<td>aequitas</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>train<sub>results</sub></td>
<td>evaluations</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>train<sub>results</sub></td>
<td>feature<sub>importances</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>train<sub>results</sub></td>
<td>predictions</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
</tbody>
</table>
<h2 id="what-are-all-the-results-tables-about">What are all the results tables about?<a class="headerlink" href="#what-are-all-the-results-tables-about" title="Permanent link">#</a></h2>
<p><code>model_groups</code> stores the algorithm (<code>model_type</code>), the hyperparameters (<code>hyperparameters</code>), and the features shared by a particular set of models. <code>models</code> contains data specific to a model: the <code>model_group</code> (you can use <code>model_group_id</code> for linking the model to a model group), temporal information (like <code>train_end_time</code>), and the train matrix UUID (<code>train_matrix_uuid</code>). This <strong>UUID</strong> is important because it's the name of the file in which the matrix is stored.</p>
<p>Lastly, <code>{train, test}_results.predictions</code> contains all the <em>scores</em> generated by every model for every entity. <code>{train_test}_results.evaluation</code> stores the value of all the <strong>metrics</strong> for every model, which were specified in the <code>scoring</code> section in the config file.</p>
<h3 id="triage_metadataexperiments"><code>triage_metadata.experiments</code><a class="headerlink" href="#triage_metadataexperiments" title="Permanent link">#</a></h3>
<p>This table has the two columns: <code>experiment_hash</code> and <code>config</code></p>
<div class="highlight"><pre><span></span><code><span class="err">\</span><span class="n">d</span><span class="w"> </span><span class="n">triage_metadata</span><span class="p">.</span><span class="n">experiments</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Table "model<sub>metadata.experiments</sub>"</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Type</td>
<td>Collation</td>
<td>Nullable</td>
<td>Default</td>
</tr>
<tr>
<td>experiment<sub>hash</sub></td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>config</td>
<td>jsonb</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Indexes:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"experiments<sub>pkey</sub>" PRIMARY KEY, btree (experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Referenced by:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.experiment</sub><sub>matrices</sub>" CONSTRAINT "experiment<sub>matrices</sub><sub>experiment</sub><sub>hash</sub><sub>fkey</sub>" FOREIGN KEY (experiment<sub>hash</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.experiment</sub><sub>models</sub>" CONSTRAINT "experiment<sub>models</sub><sub>experiment</sub><sub>hash</sub><sub>fkey</sub>" FOREIGN KEY (experiment<sub>hash</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.matrices</sub>" CONSTRAINT "matrices<sub>built</sub><sub>by</sub><sub>experiment</sub><sub>fkey</sub>" FOREIGN KEY (built<sub>by</sub><sub>experiment</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.models</sub>" CONSTRAINT "models<sub>experiment</sub><sub>hash</sub><sub>fkey</sub>" FOREIGN KEY (built<sub>by</sub><sub>experiment</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><code>experiment_hash</code> contains the hash of the configuration file that we used for our <code>triage</code> run.<sup><a class="footref" href="#fn.1" id="fnr.1">1</a></sup> <code>config</code> that contains the configuration experiment file that we used for our <code>triage</code> run, stored as <code>jsonb</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">experiment_hash</span><span class="p">,</span><span class="w"></span>
<span class="n">config</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">  </span><span class="s1">'user_metadata'</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">user_metadata</span><span class="w"></span>
<span class="k">from</span><span class="w"> </span><span class="n">triage_metadata</span><span class="p">.</span><span class="n">experiments</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>experiment<sub>hash</sub></th>
<th>user<sub>metadata</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td>67a1d564d31811b9c20ca63672c25abd</td>
<td>{"org": "DSaPP", "team": "Tutorial", "author": "Adolfo De Unanue", "etl<sub>date</sub>": "2019-02-21", "experiment<sub>type</sub>": "test", "label<sub>definition</sub>": "failed<sub>inspection</sub>"}</td>
</tr>
</tbody>
</table>
<p>We could use the following advice: If we are interested in all models that resulted from a certain config, we could lookup that config in <code>triage_metadata.experiments</code> and then use its <code>experiment_hash</code> on other tables to find all the models that resulted from that configuration.</p>
<h3 id="metadata_modelmodel_groups"><code>metadata_model.model_groups</code><a class="headerlink" href="#metadata_modelmodel_groups" title="Permanent link">#</a></h3>
<p>Do you remember how we defined in <code>grid_config</code> the different classifiers that we want <code>triage</code> to train? For example, we could use in a configuration file the following:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="s">'sklearn.tree.DecisionTreeClassifier'</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">criterion</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">'entropy'</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">        </span><span class="nt">max_depth</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">        </span><span class="nt">random_state</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2193</span><span class="p p-Indicator">]</span><span class="w"></span>
</code></pre></div>
<p>By doing so, we are saying that we want to train 4 decision trees (<code>max_depth</code> is one of <code>1, 2, 5, 10</code>). However, remember that we are using temporal crossvalidation to build our models, so we are going to have different temporal slices that we are training models on, e.g., 2010-2011, 2011-2012, etc.</p>
<p>Therefore, we are going to train our four decision trees on each temporal slice. Therefore, the trained model (or the instance of that model) will change across temporal splits, but the configuration will remain the same. This table lets us keep track of the different configurations (<code>model_groups</code>) and gives us an <code>id</code> for each configuration (<code>model_group_id</code>). We can leverage the <code>model_group_id</code> to find all the models that were trained using the same config but on different slices of time.</p>
<p>In our simple test configuration file we have:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="s">'sklearn.dummy.DummyClassifier'</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">strategy</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">most_frequent</span><span class="p p-Indicator">]</span><span class="w"></span>
</code></pre></div>
<p>Therefore, if we run the following</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"></span>
<span class="w">    </span><span class="n">model_group_id</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">model_type</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">hyperparameters</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">model_config</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s1">'feature_groups'</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">feature_groups</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">model_config</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s1">'cohort_name'</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cohort</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">model_config</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s1">'label_name'</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">model_config</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s1">'label_definition'</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">label_definition</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">model_config</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s1">'experiment_type'</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">experiment_type</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">model_config</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s1">'etl_date'</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">etl_date</span><span class="w"></span>
<span class="k">from</span><span class="w"></span>
<span class="w">    </span><span class="n">triage_metadata</span><span class="p">.</span><span class="n">model_groups</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>model<sub>group</sub><sub>id</sub></th>
<th>model<sub>type</sub></th>
<th>hyperparameters</th>
<th>feature<sub>groups</sub></th>
<th>cohort</th>
<th>label</th>
<th>label<sub>definition</sub></th>
<th>experiment<sub>type</sub></th>
<th>etl<sub>date</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>sklearn.dummy.DummyClassifier</td>
<td>{"strategy": "most<sub>frequent</sub>"}</td>
<td>["prefix: results", "prefix: risks", "prefix: inspections"]</td>
<td>"test<sub>facilities</sub>"</td>
<td>"failed<sub>inspections</sub>"</td>
<td>"failed<sub>inspection</sub>"</td>
<td>"test"</td>
<td>"2019-02-21"</td>
</tr>
</tbody>
</table>
<p>You can see that a model group is defined by the classifier (<code>model_type</code>), its hyperparameters (<code>hyperparameters</code>), the features (<code>feature_list</code>) (not shown), and the <code>model_config</code>.</p>
<p>The field <code>model_config</code> is created using information from the block <code>model_group_keys</code>. In our test configuration file the block is:</p>
<div class="highlight"><pre><span></span><code><span class="nt">model_group_keys</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'class_path'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'parameters'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'feature_names'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'feature_groups'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'cohort_name'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'state'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'label_name'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'label_timespan'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'training_as_of_date_frequency'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'max_training_history'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'label_definition'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'experiment_type'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'org'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'team'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'author'</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">'etl_date'</span><span class="w"></span>
</code></pre></div>
<p><em>What can we learn from that?</em> For example, if we add a new feature and rerun <code>triage</code>, <code>triage</code> will create a new <code>model_group</code> even if the classifier and the <code>hyperparameters</code> are the same as before.</p>
<h3 id="triage_metadatamodels"><code>triage_metadata.models</code><a class="headerlink" href="#triage_metadatamodels" title="Permanent link">#</a></h3>
<p>This table stores the information about our actual <em>models</em>, i.e., instances of our classifiers trained on specific temporal slices.</p>
<div class="highlight"><pre><span></span><code><span class="err">\</span><span class="n">d</span><span class="w"> </span><span class="n">triage_metadata</span><span class="p">.</span><span class="n">models</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Table "model<sub>metadata.models</sub>"</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Type</td>
<td>Collation</td>
<td>Nullable</td>
<td>Default</td>
</tr>
<tr>
<td>model<sub>id</sub></td>
<td>integer</td>
<td></td>
<td>not null</td>
<td>nextval('model<sub>metadata.models</sub><sub>model</sub><sub>id</sub><sub>seq</sub>'::regclass)</td>
</tr>
<tr>
<td>model<sub>group</sub><sub>id</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>model<sub>hash</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>run<sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>batch<sub>run</sub><sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>model<sub>type</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>hyperparameters</td>
<td>jsonb</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>model<sub>comment</sub></td>
<td>text</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>batch<sub>comment</sub></td>
<td>text</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>config</td>
<td>json</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>built<sub>by</sub><sub>experiment</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>train<sub>end</sub><sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>test</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>train<sub>matrix</sub><sub>uuid</sub></td>
<td>text</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>training<sub>label</sub><sub>timespan</sub></td>
<td>interval</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>model<sub>size</sub></td>
<td>real</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Indexes:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"models<sub>pkey</sub>" PRIMARY KEY, btree (model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"ix<sub>results</sub><sub>models</sub><sub>model</sub><sub>hash</sub>" UNIQUE, btree (model<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Foreign-key constraints:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"matrix<sub>uuid</sub><sub>for</sub><sub>models</sub>" FOREIGN KEY (train<sub>matrix</sub><sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"models<sub>experiment</sub><sub>hash</sub><sub>fkey</sub>" FOREIGN KEY (built<sub>by</sub><sub>experiment</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"models<sub>model</sub><sub>group</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>group</sub><sub>id</sub>) REFERENCES model<sub>metadata.model</sub><sub>groups</sub>(model<sub>group</sub><sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Referenced by:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "test<sub>results.evaluations</sub>" CONSTRAINT "evaluations<sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.feature</sub><sub>importances</sub>" CONSTRAINT "feature<sub>importances</sub><sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "test<sub>results.individual</sub><sub>importances</sub>" CONSTRAINT "individual<sub>importances</sub><sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.list</sub><sub>predictions</sub>" CONSTRAINT "list<sub>predictions</sub><sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "test<sub>results.predictions</sub>" CONSTRAINT "predictions<sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.evaluations</sub>" CONSTRAINT "train<sub>evaluations</sub><sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.predictions</sub>" CONSTRAINT "train<sub>predictions</sub><sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Noteworthy columns are:</p>
<ul>
<li><strong><code>model_id</code>:</strong> The id of the model (i.e., instance…). We will use this ID to trace a model evaluation to a <code>model_group</code> and vice versa.</li>
<li><strong><code>model_group_id</code>:</strong> The id of the models <em>model group</em> we encountered above.</li>
<li><strong><code>model_hash</code>:</strong> The <em>hash</em> of our model. We can use the hash to load the actual model. It gets stored under <code>TRIAGE_OUTPUT_PATH/trained_models/{model_hash}</code>. We are going to this later to look at a trained decision tree.</li>
<li><strong><code>run_time</code>:</strong> Time when the model was trained.</li>
<li><strong><code>model_type</code>:</strong> The algorithm used for training.</li>
<li><strong><code>model_comment</code>:</strong> Literally the text in the <code>model_comment</code> block in the configuration file</li>
<li><strong><code>hyperparameters</code>:</strong> Hyperparameters used for the model configuration.</li>
<li><strong><code>built_by_experiment</code>:</strong> The hash of our experiment. We encountered this value in the <code>results.experiments</code> table before.</li>
<li><strong><code>train_end_time</code>:</strong> When building the training matrix, we included training samples up to this date.</li>
<li><strong><code>train_matrix_uuid</code>:</strong> The <em>hash</em> of the matrix that we used to train this model. The matrix gets stored as <code>csv</code> under <code>TRIAGE_OUTPUT_PATH/matrices/{train_matrix_uuid}.csv</code>. This is helpful when trying to inspect the matrix and features that were used for training.</li>
<li><strong><code>train_label_timespan</code>:</strong> How big was our window to get the labels for our training matrix? For example, a <code>train_label_window</code> of 1 year would mean that we look one year from a given date in the training matrix into the future to find the label for that training sample.</li>
</ul>
<h3 id="triage_metadatamatrices"><code>triage_metadata.matrices</code><a class="headerlink" href="#triage_metadatamatrices" title="Permanent link">#</a></h3>
<p>This schema contains information about the matrices used in the model's training. You could use this information to debug your models. Important columns are <code>matrix_uuid</code> (The matrix gets stored as <code>TRIAGE_OUTPUT_PATH/matrices/{train_matrix_uuid}.csv</code>), <code>matrix_type</code> (indicated if the matrix was used for <em>training</em> models or <em>testing</em> them), <code>lookback_duration</code> and <code>feature_starttime</code> (give information about the temporal setting of the features) and <code>num_observations</code> (size of the matrices).</p>
<div class="highlight"><pre><span></span><code><span class="err">\</span><span class="n">d</span><span class="w"> </span><span class="n">triage_metadata</span><span class="p">.</span><span class="n">matrices</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Table "model<sub>metadata.matrices</sub>"</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Type</td>
<td>Collation</td>
<td>Nullable</td>
<td>Default</td>
</tr>
<tr>
<td>matrix<sub>id</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>matrix<sub>uuid</sub></td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>matrix<sub>type</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>labeling<sub>window</sub></td>
<td>interval</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>num<sub>observations</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>creation<sub>time</sub></td>
<td>timestamp with time zone</td>
<td></td>
<td></td>
<td>now()</td>
</tr>
<tr>
<td>lookback<sub>duration</sub></td>
<td>interval</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>feature<sub>start</sub><sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>matrix<sub>metadata</sub></td>
<td>jsonb</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>built<sub>by</sub><sub>experiment</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Indexes:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"matrices<sub>pkey</sub>" PRIMARY KEY, btree (matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"ix<sub>model</sub><sub>metadata</sub><sub>matrices</sub><sub>matrix</sub><sub>uuid</sub>" UNIQUE, btree (matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Foreign-key constraints:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"matrices<sub>built</sub><sub>by</sub><sub>experiment</sub><sub>fkey</sub>" FOREIGN KEY (built<sub>by</sub><sub>experiment</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Referenced by:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "test<sub>results.evaluations</sub>" CONSTRAINT "evaluations<sub>matrix</sub><sub>uuid</sub><sub>fkey</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.evaluations</sub>" CONSTRAINT "evaluations<sub>matrix</sub><sub>uuid</sub><sub>fkey</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.models</sub>" CONSTRAINT "matrix<sub>uuid</sub><sub>for</sub><sub>models</sub>" FOREIGN KEY (train<sub>matrix</sub><sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "test<sub>results.predictions</sub>" CONSTRAINT "matrix<sub>uuid</sub><sub>for</sub><sub>testpred</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.predictions</sub>" CONSTRAINT "matrix<sub>uuid</sub><sub>for</sub><sub>trainpred</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.predictions</sub>" CONSTRAINT "train<sub>predictions</sub><sub>matrix</sub><sub>uuid</sub><sub>fkey</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="test-train_resultsevaluations"><code>{test, train}_results.evaluations</code><a class="headerlink" href="#test-train_resultsevaluations" title="Permanent link">#</a></h3>
<p>These tables lets us analyze how well our models are doing. Based on the config that we used for our <code>triage</code> run, <code>triage</code> is calculating metrics and storing them in this table, e.g., our model's precision in top 10%.</p>
<div class="highlight"><pre><span></span><code><span class="err">\</span><span class="n">d</span><span class="w"> </span><span class="n">test_results</span><span class="p">.</span><span class="n">evaluations</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Table "test<sub>results.evaluations</sub>"</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Type</td>
<td>Collation</td>
<td>Nullable</td>
<td>Default</td>
</tr>
<tr>
<td>model<sub>id</sub></td>
<td>integer</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>evaluation<sub>start</sub><sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>evaluation<sub>end</sub><sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>as<sub>of</sub><sub>date</sub><sub>frequency</sub></td>
<td>interval</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>metric</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>parameter</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>value</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>num<sub>labeled</sub><sub>examples</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>num<sub>labeled</sub><sub>above</sub><sub>threshold</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>num<sub>positive</sub><sub>labels</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>sort<sub>seed</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>matrix<sub>uuid</sub></td>
<td>text</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Indexes:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"evaluations<sub>pkey</sub>" PRIMARY KEY, btree (model<sub>id</sub>, evaluation<sub>start</sub><sub>time</sub>, evaluation<sub>end</sub><sub>time</sub>, as<sub>of</sub><sub>date</sub><sub>frequency</sub>, metric, parameter)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Foreign-key constraints:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"evaluations<sub>matrix</sub><sub>uuid</sub><sub>fkey</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"evaluations<sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Its columns are:</p>
<ul>
<li><strong><code>model_id</code>:</strong> Our beloved <code>model_id</code> that we have encountered before.</li>
<li><strong><code>evaluation_start_time</code>:</strong> After training the model, we evaluate it on a test matrix. This column tells us the earliest time that an example in our test matrix could have.</li>
<li><strong><code>evaluation_end_time</code>:</strong> After training the model, we evaluate it on a test matrix. This column tells us the latest time that an example in our test matrix could have.</li>
<li><strong><code>metric</code>:</strong> Indicates which metric we are evaluating, e.g., <code>precision@</code>.</li>
<li><code>parameter</code> ::Indicates at which parameter we are evaluating our metric, e.g., a metric of precision@ and a parameter of <code>100.0_pct</code> shows us the <code>precision@100pct</code>.</li>
<li><strong><code>value</code>:</strong> The value observed for our metric@parameter.</li>
<li><strong><code>num_labeled_examples</code>:</strong> The number of labeled examples in our test matrix. Why does it matter? It could be the case that we have entities that have no label for the test timeframe (for example, not all facilities will have an inspection). We still want to make predictions for these entities but can't include them when calculating performance metrics.</li>
<li><strong><code>num_labeled_above_threshold</code>:</strong> How many examples above our threshold were labeled?</li>
<li><strong><code>num_positive_labels</code>:</strong> The number of rows that had true positive labels.</li>
</ul>
<p>A look at the table shows that we have multiple rows for each model, each showing a different performance metric.</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"></span>
<span class="w">    </span><span class="n">evaluation_end_time</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">model_id</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">metric</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">metric</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">value</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">num_labeled_examples</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">num_labeled_above_threshold</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">num_positive_labels</span><span class="w"></span>
<span class="k">from</span><span class="w"></span>
<span class="w">    </span><span class="n">test_results</span><span class="p">.</span><span class="n">evaluations</span><span class="w"></span>
<span class="k">where</span><span class="w"></span>
<span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'100.0_pct'</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>evaluation<sub>end</sub><sub>time</sub></th>
<th>model<sub>id</sub></th>
<th>metric</th>
<th>value</th>
<th>num<sub>labeled</sub><sub>examples</sub></th>
<th>num<sub>labeled</sub><sub>above</sub><sub>threshold</sub></th>
<th>num<sub>positive</sub><sub>labels</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td>2016-01-01 00:00:00</td>
<td>1</td>
<td>precision@100.0<sub>pct</sub></td>
<td>0.6666666666666666</td>
<td>3</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>2016-01-01 00:00:00</td>
<td>1</td>
<td>recall@100.0<sub>pct</sub></td>
<td>1.0</td>
<td>3</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>2017-01-01 00:00:00</td>
<td>2</td>
<td>precision@100.0<sub>pct</sub></td>
<td>0.3333333333333333</td>
<td>3</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>2017-01-01 00:00:00</td>
<td>2</td>
<td>recall@100.0<sub>pct</sub></td>
<td>1.0</td>
<td>3</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Remember that at 100%, the <code>recall</code> should be 1, and the <code>precision</code> is equal to the <em>baserate</em>. If these two things don't match, there are problems in your data, pipeline, etl. You must get this correct!</p>
</blockquote>
<p><em>What does this query tell us?</em></p>
<p>We can now see how the different instances (trained on different temporal slices, but with the same model params) of a model group performs over time. Note how we only included the <em>models</em> that belong to our <em>model group</em> <code>1</code>.</p>
<h3 id="test_train_resultsaequitas"><code>{test_train}_results.aequitas</code><a class="headerlink" href="#test_train_resultsaequitas" title="Permanent link">#</a></h3>
<p>Standard evaluation metrics don't tell us the entire story: what are the biases in our models? what is the fairest model?<br/>
Given the <code>bias_audit_config</code> in the experiment config in which we defined what protected attributes we care about (e.g. ethnicity) and the specific thresholds our model is going to be used,
Triage uses Aequitas to generate a bias report on each model and matrix, similar to standard evaluation metrics.
The <code>aequitas</code> tables will have a row for each combination of:
- model_id
- subset_hash
- tie_breaker (e.g. best, worst)
- evaluation_start_time
- evaluation_end_time
- parameter (e.g. <code>25_abs</code>, similar to evaluation metric thresholds)
- attribute_name (e.g. 'facility_type')
- attribute_value (e.g. 'kids_facility', 'restaurant')</p>
<p>For each row Aequitas calculates the following group metrics:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Formula</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Predicted Positive</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20PP_g"/></td>
<td>The number of entities within a group where the decision is positive, i.e.,  <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cwidehat%7BY%7D%3D1."/></td>
</tr>
<tr>
<td><strong>Total Predictive Positive</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20K%20%3D%20%5Csum_%7BA%3Da_1%7D%5E%7BA%3Da_n%7D%20PP_%7Bg%28a_i%29%7D"/></td>
<td>The total number of entities predicted positive across groups defined by <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20A."/></td>
</tr>
<tr>
<td><strong>Predicted Negative</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20PN_g"/></td>
<td>The number of entities within a group which decision is negative, i.e.,  <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20%5Cwidehat%7BY%7D%3D0."/></td>
</tr>
<tr>
<td><strong>Predicted Prevalence</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?PPrev_g%20%3D%20%5Cfrac%7BPP_g%7D%7B%7Cg%7C%7D%20%3D%20%5Ctext%7BPr%28%7D%5Cwidehat%7BY%7D%3D1%5C%3B%7C%5C%3BA%3Da_i%29"/></td>
<td>The fraction of entities within a group which were predicted as positive.</td>
</tr>
<tr>
<td><strong>Predicted Positive Rate</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?PPR_g%20%3D%20%5Cfrac%7BPP_g%7D%7BK%7D%20%3D%20%5Ctext%7BPr%28%7DA%3Da_i%5C%3B%7C%5C%3B%5Cwidehat%7BY%7D%3D1%29"/></td>
<td>The fraction of the entities predicted as positive that belong to a certain group.</td>
</tr>
<tr>
<td><strong>False Positive</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20FP_g"/></td>
<td>The number of entities of the group with <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20%5Cwidehat%7BY%7D%3D1"/> and <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20Y%3D0."/></td>
</tr>
<tr>
<td><strong>False Negative</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20FN_g"/></td>
<td>The number of entities of the group with <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20%5Cwidehat%7BY%7D%3D0"/> and <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20Y%3D1."/></td>
</tr>
<tr>
<td><strong>True Positive</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20TP_g"/></td>
<td>The number of entities of the group with <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20%5Cwidehat%7BY%7D%3D1"/> and <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20Y%3D1."/></td>
</tr>
<tr>
<td><strong>True Negative</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20TN_g"/></td>
<td>The number of entities of the group with <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20%5Cwidehat%7BY%7D%3D0"/> and <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20Y%3D0."/></td>
</tr>
<tr>
<td><strong>False Discovery Rate</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?FDR_g%20%3D%20%5Cfrac%7BFP_g%7D%7BPP_g%7D%20%3D%20%5Ctext%7BPr%28%7DY%3D0%5C%3B%7C%5C%3B%5Cwidehat%7BY%7D%3D1%2CA%3Da_i%29"/></td>
<td>The fraction of false positives of a group within the predicted positive of the group.</td>
</tr>
<tr>
<td><strong>False Omission Rate</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?FOR_g%20%3D%20%5Cfrac%7BFN_g%7D%7BPN_g%7D%20%3D%20%5Ctext%7BPr%28%7DY%3D1%5C%3B%7C%5C%3B%5Cwidehat%7BY%7D%3D0%2CA%3Da_i%29"/></td>
<td>The fraction of false negatives of a group within the predicted negative of the group.</td>
</tr>
<tr>
<td><strong>False Positive Rate</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?FPR_g%20%3D%20%5Cfrac%7BFP_g%7D%7BLN_g%7D%20%3D%20%5Ctext%7BPr%28%7D%5Cwidehat%7BY%7D%3D1%5C%3B%7C%5C%3BY%3D0%2CA%3Da_i%29"/></td>
<td>The fraction of false positives of a group within the labeled negative of the group.</td>
</tr>
<tr>
<td><strong>False Negative Rate</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?FNR_g%20%3D%20%5Cfrac%7BFN_g%7D%7BLP_g%7D%20%3D%20%5Ctext%7BPr%28%7D%5Cwidehat%7BY%7D%3D0%5C%3B%7C%5C%3BY%3D1%2C%20A%3Da_i%29"/></td>
<td>The fraction of false negatives of a group within the labeled positives of the group.</td>
</tr>
</tbody>
</table>
<p>In the context of public policy and social good we want to avoid providing less benefits to specific groups of entities, if the intervention is assistive, as well as, avoid hurting more
specific groups, if the intervention is punitive. Therefore we define bias as a disparity measure of group metric values of a given group when compared with a reference group. This
reference can be selected using different criteria. For instance, one could use the majority group (with larger size) across the groups defined by A, or the group with minimum
group metric value, or the traditional approach of fixing a historically favored group (e.g ethnicity:caucasian).</p>
<p>Each disparity metric <img src="http://latex.codecogs.com/gif.latex?j"/> for a given group <img src="http://latex.codecogs.com/gif.latex?a_i"/> is calculated as follows:
<img src="http://latex.codecogs.com/gif.latex?disparity_%7Bj%2C%5C%3Ba_%7Bi%7D%7D%20%3D%20%5Cfrac%7Bmetric_%7Bj%2C%5C%3Ba_%7Bi%7D%7D%7D%7Bmetric_%7Bj%2C%5C%3Ba_%7Breference%5C%3Bgroup%7D%7D%7D"/></p>
<p>To read about the bias metrics saved in this table, look at the <a href="https://dssg.github.io/aequitas/output_data.html">Aequitas documentation</a>.</p>
<table>
<thead>
<tr>
<th>Table "test_results.aequitas"</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Type</td>
<td>Collation</td>
<td>Nullable</td>
<td>Default</td>
</tr>
<tr>
<td>model_id</td>
<td>integer</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>subset_hash</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>tie_breaker</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>evaluation_start_time</td>
<td>timestamp without time zone</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>evaluation_end_time</td>
<td>timestamp without time zone</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>matrix_uuid</td>
<td>text</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>parameter</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>attribute_name</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>attribute_value</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>total_entities</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>group_label_pos</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>group_label_neg</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>group_size</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>group_size_pct</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>prev</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>pp</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>pn</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fp</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fn</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tn</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tp</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ppr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>pprev</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tpr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tnr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>for</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fdr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fpr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fnr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>npv</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>precision</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ppr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ppr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>pprev_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>pprev_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>precision_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>precision_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fdr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fdr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>for_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>for_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fpr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fpr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fnr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fnr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tpr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tpr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tnr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tnr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>npv_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>npv_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Statistical_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Impact_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>FDR_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>FPR_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>FOR_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>FNR_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TypeI_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TypeII_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Equalized_Odds</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Unsupervised_Fairness</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Supervised_Fairness</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="test-train_resultspredictions"><code>{test, train}_results.predictions</code><a class="headerlink" href="#test-train_resultspredictions" title="Permanent link">#</a></h3>
<p>You can think of the previous table <code>{test, train}_results.{test, train}_predictions</code> as a summary of individuals predictions that our model is making. But where can you find the individual predictions that our model is making? (So you can generate a list from here). And where can we find the test matrix that the predictions are based on? Let us introduce you to the <code>results.predictions</code> table.</p>
<p>Here is what its first row looks like:</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"></span>
<span class="w">    </span><span class="n">model_id</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">entity_id</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">as_of_date</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">score</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">label_value</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_uuid</span><span class="w"></span>
<span class="k">from</span><span class="w"></span>
<span class="w">    </span><span class="n">test_results</span><span class="p">.</span><span class="n">predictions</span><span class="w"></span>
<span class="k">where</span><span class="w"></span>
<span class="w">    </span><span class="n">model_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="k">desc</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<table>
<thead>
<tr>
<th>model<sub>id</sub></th>
<th>entity<sub>id</sub></th>
<th>as<sub>of</sub><sub>date</sub></th>
<th>score</th>
<th>label<sub>value</sub></th>
<th>matrix<sub>uuid</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>229</td>
<td>2016-01-01 00:00:00</td>
<td>1.0</td>
<td>1</td>
<td>cd0ae68d6ace43033b49ee0390c3583e</td>
</tr>
<tr>
<td>1</td>
<td>355</td>
<td>2016-01-01 00:00:00</td>
<td>1.0</td>
<td>1</td>
<td>cd0ae68d6ace43033b49ee0390c3583e</td>
</tr>
<tr>
<td>1</td>
<td>840</td>
<td>2016-01-01 00:00:00</td>
<td>1.0</td>
<td>0</td>
<td>cd0ae68d6ace43033b49ee0390c3583e</td>
</tr>
</tbody>
</table>
<p>As you can see, the table contains our models' predictions for a given entity and date.</p>
<p>And do you notice the field <code>matrix_uuid</code>? Doesn't it look similar to the fields from above that gave us the names of our training matrices? In fact, it is the same. You can find the test matrix that was used to make this prediction under <code>TRIAGE_OUTPUT_PATH/matrices/{matrix_uuid}.csv</code>.</p>
<h3 id="test-train_resultsfeature_importances"><code>{test, train}_results.feature_importances</code><a class="headerlink" href="#test-train_resultsfeature_importances" title="Permanent link">#</a></h3>
<p>This tables store the feature importance of all the models.</p>
<h2 id="footnotes">Footnotes<a class="headerlink" href="#footnotes" title="Permanent link">#</a></h2>
<p><sup><a class="footnum" href="#fnr.1" id="fn.1">1</a></sup> Literally from the configuration file. If you modify something it will generate a new hash. Handle with care!</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a class="md-footer__link md-footer__link--prev" href="../../postmodeling/postmodeling-config/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Postmodeling &amp; Crosstabs Configuration
            </div>
</div>
</a>
<a class="md-footer__link md-footer__link--next" href="../../predictlist/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Predictlist
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
<div class="md-footer-social">
<a class="md-footer-social__link" href="https://github.com/dssg/triage" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://twitter.com/datascifellows" rel="noopener" target="_blank" title="twitter.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://linkedin.com/company/center-for-data-science-and-public-policy-university-of-chicago" rel="noopener" target="_blank" title="linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
<script src="../../js/mermaid.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
</html>